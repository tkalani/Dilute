{% extends 'users/main.html' %}
	{% block head %}
		{% load staticfiles %}
			<script src="http://code.jquery.com/jquery-1.4.min.js"></script>
			<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
			<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
			<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
			<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
			<script src="//cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.0/Chart.min.js" type="text/javascript"></script>

            <script type="text/javascript" src="{% static 'users/js/ajaxSetup.js' %}"></script>
			<style>
			    .row {	display: flex;	}
			    .col {	flex: 1;	}
                .loader1 { display: none; }
                .loader2 { display: none; }
                .loader3 { display: none; }
                .loader4 { display: none; }
                .loader-text {
                    color : #3498DB;
                    font-size : 30px;
                }
                .div-canvas{
                    height: 500px;
                    width: 80%;
                }
                .td-left{   text-align: left;  }
                .td-right { text-align: right;  }
                .td-cell { width: 50%; }
                .graph-heading { text-align: center; }
			</style>
	{% endblock %}
	{% block body %}
		{% block main %}
			{% block mydashboard %}
			{% endblock %}
			<center>
			    <div style="padding-left: 15px; width:90%;" class="w3-row-padding w3-margin-bottom">
			        <div id="tabs" style="margin-top: 25px;">
			            <ul>
                            <li>
                                <a href="#tabs-5">Main Tank</a>
                            </li>
                            <li>
                                <a href="#tabs-6">Quantum Tank</a>
                            </li>
			                <li>
			                    <a href="#tabs-1">Drinking Water</a>
			                </li>
			                <li>
			                    <a href="#tabs-2">Bathing Water</a>
			                </li>
			                <li>
			                    <a href="#tabs-3">Water for Plants</a>
			                </li>
			                <li>
			                    <a href="#tabs-4">Car Wash Water</a>
			                </li>
			            </ul>
			            <br>
                        <div class="row">
                            <table>
                                <tr>
                                    <td class="td-left td-cell">
                                        From : <input type="date" id="start_date"> &nbsp;&nbsp;&nbsp;
                                        To : <input type="date" id="end_date" disabled>
                                    </td>
                                    <td class="td-right td-cell">
                                        <button id="date-range-submit" class="date-range-submit w3-button w3-blue" disabled>SUBMIT</button>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="graph-heading" id="group-heading">
                            <strong>All Time Data</strong>
                        </div>
                        <div id="tabs-5">
                            <div class="container5">
                                <div class="div-canvas" id="con5">
                                    <canvas id="MainTankGraph" style="max-height: 50px, max-width: 50px !important;"></canvas>
                                </div>
                            </div>
                            <div class="loader5" style="height: 500px; width: 900px;">
                               <center>
                                   <img class="loading-image" src="{% static 'users/img/loader1.gif' %}" alt="loading..">
                                   <p class="loader-text"><strong>DILUTING</strong> out <strong>DATA</strong> ...</p>
                               </center>
                            </div>
                        </div>
                        <div id="tabs-6">
                            <div class="container6">
                                <div class="div-canvas" id="con6">
                                    <canvas id="QuantumTankGraph" style="max-height: 50px, max-width: 50px !important;"></canvas>
                                </div>
                            </div>
                            <div class="loader6" style="height: 500px; width: 900px;">
                               <center>
                                   <img class="loading-image" src="{% static 'users/img/loader1.gif' %}" alt="loading..">
                                   <p class="loader-text"><strong>DILUTING</strong> out <strong>DATA</strong> ...</p>
                               </center>
                            </div>
                        </div>
			            <div id="tabs-1">
			                <div class="container1">
			                    <div class="div-canvas" id="con1">
			                        <canvas id="drinkingWaterGraph" style="max-height: 50px, max-width: 50px !important;"></canvas>
			                    </div>
			                </div>
                            <div class="loader1" style="height: 500px; width: 900px;" >
                               <center>
                                   <img class="loading-image" src="{% static 'users/img/loader1.gif' %}" alt="loading..">
                                   <p class="loader-text"><strong>DILUTING</strong> out <strong>DATA</strong> ...</p>
                               </center>
                            </div>
			            </div>
			            <div id="tabs-2">
			                <div class="container2">
			                    <div class="div-canvas" id="con2">
			                        <canvas id="bathingWaterGraph" style="height: 50px, width: 50px !important;"></canvas>
			                    </div>
			                </div>
                            <div class="loader2" style="height: 500px; width: 900px;" >
                               <center>
                                   <img class="loading-image" src="{% static 'users/img/loader1.gif' %}" alt="loading..">
                                   <p class="loader-text"><strong>DILUTING</strong> out <strong>DATA</strong> ...</p>
                               </center>
                            </div>
			            </div>
			            <div id="tabs-3">
			                <div class="container3">
			                    <div class="div-canvas" id="con3">
			                        <canvas id="plantWaterGraph" style="height: 50px, width: 50px !important;"></canvas>
			                    </div>
			                </div>
                            <div class="loader3" style="height: 500px; width: 900px;" >
                               <center>
                                   <img class="loading-image" src="{% static 'users/img/loader1.gif' %}" alt="loading..">
                                   <p class="loader-text"><strong>DILUTING</strong> out <strong>DATA</strong> ...</p>
                               </center>
                            </div>
			            </div>
			            <div id="tabs-4">
			                <div class="container4">
			                    <div class="div-canvas" id="con4">
			                        <canvas id="carWashWaterGraph" style="height: 50px, width: 50px !important;"></canvas>
			                    </div>
			                </div>
                            <div class="loader4" style="height: 500px; width: 900px;" >
                               <center>
                                   <img class="loading-image" src="{% static 'users/img/loader1.gif' %}" alt="loading..">
                                   <p class="loader-text"><strong>DILUTING</strong> out <strong>DATA</strong> ...</p>
                               </center>
                            </div>
			            </div>
                        <div class="container7">
                                <div class="div-canvas" id="con7">
                                    <canvas id="QualityGraph" style="height: 50px, width: 50px !important;"></canvas>
                                </div>
                            </div>
			        </div>
			    </div>
			</center>
		{% endblock %}
	{% endblock %} 

	{% block script %}
	<script>
		$("#tabs").tabs();

        function show_data_of_DateRange(start_date, end_date)
        {

            $.ajax({
                url: "{% url 'users:showDataDateRange' %}",
                type: "POST",
                dataType: 'json',
                data: { 'start_date': start_date, 'end_date': end_date, "csrfmiddlewaretoken": '{{ csrf_token }}' },
                success: function(data) {
                    console.log(data);

                    var heading = "<strong>" + String(start_date) + "</strong> to <strong>" + String(end_date) + "</strong>";
                    document.getElementById('group-heading').innerHTML = heading;

                    $('#MainTankGraph').remove();
                    $('#QuantumTankGraph').remove();
                    $('#drinkingWaterGraph').remove();
                    $('#bathingWaterGraph').remove();
                    $('#plantWaterGraph').remove();
                    $('#carWashWaterGraph').remove();
                    $('#QualityGraph').remove();

                    $('#con5').append('<canvas id="MainTankGraph"><canvas>');
                    $('#con6').append('<canvas id="QuantumTankGraph"><canvas>');
                    $('#con1').append('<canvas id="drinkingWaterGraph"><canvas>');
                    $('#con2').append('<canvas id="bathingWaterGraph"><canvas>');
                    $('#con3').append('<canvas id="plantWaterGraph"><canvas>');
                    $('#con4').append('<canvas id="carWashWaterGraph"><canvas>');
                    $('#con7').append('<canvas id="QualityGraph"><canvas>');

                    var ctx5 = document.querySelector("#MainTankGraph").getContext('2d');
                    var ctx6 = document.querySelector("#QuantumTankGraph").getContext('2d');
                    var ctx1 = document.querySelector("#drinkingWaterGraph").getContext('2d');
                    var ctx2 = document.querySelector("#bathingWaterGraph").getContext('2d');
                    var ctx3 = document.querySelector("#plantWaterGraph").getContext('2d');
                    var ctx4 = document.querySelector("#carWashWaterGraph").getContext('2d');
                    var ctx7 = document.querySelector("#QualityGraph").getContext('2d');

                    var myChart1 = new Chart(ctx1, {
                    type: 'line',
                    responsive: false,
                    width: 100,
                    height: 100,
                    data: {
                        labels: data.category_time,
                        datasets: [{
                            label: 'Drinking Water Level ( in % )',
                            data: data.plantWater,
                            fill: true,
                            lineTension: 0.1,
                            backgroundColor: "rgba(251, 220, 19, 0.4)",
                            borderColor: "rgba(251, 220, 19, 1)",
                            borderCapStyle: 'butt',
                            borderDash: [],
                            borderDashOffset: 0.0,
                            borderJoinStyle: 'miter',
                            pointBorderColor: "rgba(242,34,34,1)",
                            pointBackgroundColor: "#fff",
                            pointBorderWidth: 1,
                            pointHoverRadius: 5,
                            pointHoverBackgroundColor: "rgba(242,34,34,1)",
                            pointHoverBorderColor: "rgba(220,220,220,1)",
                            pointHoverBorderWidth: 2,
                            pointRadius: 1,
                            pointHitRadius: 10,

                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                });

                var myChart2 = new Chart(ctx2, {
                    type: 'line',
                    responsive: false,
                    width: 100,
                    height: 100,
                    data: {

                        labels: data.category_time,
                        datasets: [{
                            label: 'Bathing Water Level ( in % )',
                            data: data.bathingWater,
                            fill: true,
                            lineTension: 0.1,
                            backgroundColor: "rgba(161, 100, 2, 0.4)",
                            borderColor: "rgba(161, 100, 2, 1)",
                            borderCapStyle: 'butt',
                            borderDash: [],
                            borderDashOffset: 0.0,
                            borderJoinStyle: 'miter',
                            pointBorderColor: "rgba(242,34,34,1)",
                            pointBackgroundColor: "#fff",
                            pointBorderWidth: 1,
                            pointHoverRadius: 5,
                            pointHoverBackgroundColor: "rgba(242,34,34,1)",
                            pointHoverBorderColor: "rgba(220,220,220,1)",
                            pointHoverBorderWidth: 2,
                            pointRadius: 1,
                            pointHitRadius: 10,

                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                });

                var myChart3 = new Chart(ctx3, {
                    type: 'line',
                    responsive: false,
                    width: 100,
                    height: 100,
                    data: {

                        labels: data.category_time,
                        datasets: [{
                            label: 'Plant Water Level ( in % )',
                            data: data.plantWater,
                            fill: true,
                            lineTension: 0.1,
                            backgroundColor: "rgba(4, 160, 251, 0.4)",
                            borderColor: "rgba(4, 160, 251, 1)",
                            borderCapStyle: 'butt',
                            borderDash: [],
                            borderDashOffset: 0.0,
                            borderJoinStyle: 'miter',
                            pointBorderColor: "rgba(242,34,34,1)",
                            pointBackgroundColor: "#fff",
                            pointBorderWidth: 1,
                            pointHoverRadius: 5,
                            pointHoverBackgroundColor: "rgba(242,34,34,1)",
                            pointHoverBorderColor: "rgba(220,220,220,1)",
                            pointHoverBorderWidth: 2,
                            pointRadius: 1,
                            pointHitRadius: 10,

                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                });

                var myChart4 = new Chart(ctx4, {
                    type: 'line',
                    responsive: false,
                    width: 100,
                    height: 100,
                    data: {

                        labels: data.category_time,
                        datasets: [{
                            label: 'Car Wash Water Level( in % )',
                            data: data.carWater,
                            fill: true,
                            lineTension: 0.1,
                            backgroundColor: "rgba(142, 129, 253, 0.4)",
                            borderColor: "rgba(42, 129, 253, 1)",
                            borderCapStyle: 'butt',
                            borderDash: [],
                            borderDashOffset: 0.0,
                            borderJoinStyle: 'miter',
                            pointBorderColor: "rgba(242,34,34,1)",
                            pointBackgroundColor: "#fff",
                            pointBorderWidth: 1,
                            pointHoverRadius: 5,
                            pointHoverBackgroundColor: "rgba(242,34,34,1)",
                            pointHoverBorderColor: "rgba(220,220,220,1)",
                            pointHoverBorderWidth: 2,
                            pointRadius: 1,
                            pointHitRadius: 10,

                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                });

                var myChart5 = new Chart(ctx5, {
                    type: 'line',
                    responsive: false,
                    width: 100,
                    height: 100,
                    data: {

                        labels: data.mainQuantum_time,
                        datasets: [{
                            label: 'Main Tank Water Level( in % )',
                            data: data.mainTank,
                            fill: true,
                            lineTension: 0.1,
                            backgroundColor: "rgba(142, 129, 253, 0.4)",
                            borderColor: "rgba(42, 129, 253, 1)",
                            borderCapStyle: 'butt',
                            borderDash: [],
                            borderDashOffset: 0.0,
                            borderJoinStyle: 'miter',
                            pointBorderColor: "rgba(242,34,34,1)",
                            pointBackgroundColor: "#fff",
                            pointBorderWidth: 1,
                            pointHoverRadius: 5,
                            pointHoverBackgroundColor: "rgba(242,34,34,1)",
                            pointHoverBorderColor: "rgba(220,220,220,1)",
                            pointHoverBorderWidth: 2,
                            pointRadius: 1,
                            pointHitRadius: 10,

                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                });

                var myChart6 = new Chart(ctx6, {
                    type: 'line',
                    responsive: false,
                    width: 100,
                    height: 100,
                    data: {

                        labels: data.mainQuantum_time,
                        datasets: [{
                            label: 'Qantum Tank Water Level( in % )',
                            data: data.quantumTank,
                            fill: true,
                            lineTension: 0.1,
                            backgroundColor: "rgba(142, 129, 253, 0.4)",
                            borderColor: "rgba(42, 129, 253, 1)",
                            borderCapStyle: 'butt',
                            borderDash: [],
                            borderDashOffset: 0.0,
                            borderJoinStyle: 'miter',
                            pointBorderColor: "rgba(242,34,34,1)",
                            pointBackgroundColor: "#fff",
                            pointBorderWidth: 1,
                            pointHoverRadius: 5,
                            pointHoverBackgroundColor: "rgba(242,34,34,1)",
                            pointHoverBorderColor: "rgba(220,220,220,1)",
                            pointHoverBorderWidth: 2,
                            pointRadius: 1,
                            pointHitRadius: 10,

                        }]
                    },
                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        }
                    }
                });

                var myChart7 = new Chart(ctx7, {
                    type: 'doughnut',
                    responsive: true,
                    width: 100,
                    height: 100,
                    data: {
                        labels: ["Drinking Water", "Car Water", "Bathing Water", "Plant Water"],
                        datasets: [{
                            label: 'Drinking Water Level ( in % )',
                            data: data.type_of_water,
                            backgroundColor : ['Red', 'Blue', 'Yellow', 'Green'],
                            hoverBackgroundColor : ['Red', 'Blue', 'Yellow', 'Green'],
                            hoverBorderWidth : [5, 5, 5, 5],
                            hoverBorderColor : ['Black', 'Black', 'Black', 'Black',],
                        }]
                    },
                });

                },
                error: function(data) {
                    window.alert('Kindly, check your Internet Connection');
                },
                beforeSend: function(xhr, settings){
                    $.ajaxSettings.beforeSend(xhr, settings);
                    $(".container1").hide();
                    $(".container2").hide();
                    $(".container3").hide();
                    $(".container4").hide();
                    $(".container5").hide();
                    $(".container6").hide();
                    $("#drinkingWaterGraph").hide()
                    $("#bathingWaterGraph").hide()
                    $("#plantWaterGraph").hide()
                    $("#carWashWaterGraph").hide()
                    $("#MainTankGraph").hide()
                    $("#QuantumTankGraph").hide()
                    $(".loader1").show();
                    $(".loader2").show();
                    $(".loader3").show();
                    $(".loader4").show();
                    $(".loader5").show();
                    $(".loader6").show();
                },
                complete: function(){
                    $("#drinkingWaterGraph").show();
                    $("#bathingWaterGraph").show();
                    $("#plantWaterGraph").show();
                    $("#carWashWaterGraph").show();
                    $("#MainTankGraph").show();
                    $("#QuantumTankGraph").show();
                    $(".container1").show();
                    $(".container2").show();
                    $(".container3").show();
                    $(".container4").show();
                    $(".container5").show();
                    $(".container6").show();
                    $(".loader1").hide();
                    $(".loader2").hide();
                    $(".loader3").hide();
                    $(".loader4").hide();
                    $(".loader5").hide();
                    $(".loader6").hide();
                }
            });

        }

        $('#start_date').click(function(){
            $('#end_date').removeAttr("disabled");
            $('#date-range-submit').removeAttr("disabled");
        });

        $('#date-range-submit').click(function(){
            start_date = new Date($('#start_date').val());
            start_day = start_date.getDate();
            start_month = start_date.getMonth() + 1;
            start_year = start_date.getFullYear();
            start_date = [start_year, start_month, start_day].join('-');

            end_date = new Date($('#end_date').val());
            end_day = end_date.getDate();
            end_month = end_date.getMonth() + 1;
            end_year = end_date.getFullYear();
            end_date = [end_year, end_month, end_day].join('-');

            if(end_date < start_date)
                alert("'To' Date must be before 'From' Date");
            else
                show_data_of_DateRange(start_date, end_date);
        });

		$(function () {
            today = new Date();
            start_day = today.getDate();
            start_month = today.getMonth() + 1;
            start_year = today.getFullYear();
            start_date = [start_year, start_month, start_day].join('-');
            console.log(start_date);
       	    show_data_of_DateRange(start_date, start_date);
		});
	</script>
	{% endblock %}

<!-- <!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	Logged In. <br>
	Always open django-admin in incognito.<br>
	<b>Accessing Users Attributes - </b><br>
	{{user}}, {{user.username}}, {{user.UserProf.test_field}}, {{user.UserProf.email}}
	<a href="{% url 'users:logout' %}">Sign Out</a>
</body>
</html> -->
